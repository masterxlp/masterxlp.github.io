I"’#<p>è½¬è½½è‡ª<a href="https://zhuanlan.zhihu.com/p/58987388" title="å¤šå…ƒé«˜æ–¯åˆ†å¸ƒè¯¦è§£">çŸ¥ä¹</a></p>

<h2 id="multivariate-gaussian-distribution">Multivariate Gaussian Distribution</h2>
<blockquote>
  <p>ç”±ä¸­å¿ƒæé™å®šç†æˆ‘ä»¬çŸ¥é“ï¼Œå¤§é‡ç‹¬ç«‹åŒåˆ†å¸ƒçš„éšæœºå˜é‡çš„å‡å€¼åœ¨åšé€‚å½“æ ‡å‡†åŒ–åä¼šä¾åˆ†å¸ƒæ”¶æ•›äºé«˜æ–¯åˆ†å¸ƒï¼Œè¿™ä½¿å¾—é«˜æ–¯åˆ†å¸ƒå…·æœ‰æ™®é€‚æ€§çš„å»ºæ¨¡èƒ½åŠ›.
æ•°å­¦ä¸Šï¼Œå½“ä½¿ç”¨é«˜æ–¯åˆ†å¸ƒå¯¹è´å¶æ–¯æ¨æ–­çš„ä¼¼ç„¶å’Œå…ˆéªŒè¿›è¡Œå»ºæ¨¡æ—¶ï¼Œå¾—åˆ°çš„åéªŒåŒæ ·ä¸ºé«˜æ–¯åˆ†å¸ƒï¼Œå³å…¶å…·æœ‰å…±è½­å…ˆéªŒæ€§è´¨.</p>
</blockquote>

<h3 id="å¤šå…ƒæ ‡å‡†é«˜æ–¯åˆ†å¸ƒ">å¤šå…ƒæ ‡å‡†é«˜æ–¯åˆ†å¸ƒ</h3>
<h4 id="ä¸€å…ƒé«˜æ–¯åˆ†å¸ƒ">ä¸€å…ƒé«˜æ–¯åˆ†å¸ƒ</h4>
<p>è‹¥éšæœºå˜é‡ $X \sim \mathcal{N}(\mu, \sigma^2)$ ï¼Œåˆ™æœ‰å¦‚ä¸‹çš„æ¦‚ç‡å¯†åº¦å‡½æ•°
\(\begin{align}
p(x) = \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^2} \tag{1}
\end{align}\)</p>

\[\begin{align}
1 = \int_{-\infty}^{\infty}{p(x)dx} \tag{2}
\end{align}\]

<p>è€Œå¦‚æœæˆ‘ä»¬å¯¹éšæœºå˜é‡ $X$ è¿›è¡Œæ ‡å‡†åŒ–ï¼Œä½¿ç”¨ $Z = \frac{x - \mu}{\sigma}$ å¯¹ (1) è¿›è¡Œæ¢å…ƒï¼Œç»§è€Œæœ‰
\(\begin{align}
\because\ x(z) = z \cdot \sigma + \mu
\end{align}\)</p>

\[\begin{align}
\therefore\ p(x(z)) = \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{1}{2}z^2}
\end{align}\]

\[\begin{align}
\therefore\ 1\ = \int_{-\infty}^{\infty}{p(x(z))dx}
\end{align}\]

\[\begin{align}
\qquad \qquad  = \int_{-\infty}^{\infty}{\frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{1}{2}z^2} dx}
\end{align}\]

\[\begin{align}
\qquad \quad\\\  = \int_{-\infty}^{\infty}{\frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}z^2} dz} \tag{3}
\end{align}\]

<p>æ­¤æ—¶æˆ‘ä»¬è¯´éšæœºå˜é‡ $Z \sim \mathcal{N}(0,1)$ æœä»ä¸€å…ƒæ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼Œå…¶å‡å€¼ $\mu = 0$ï¼Œæ–¹å·® $\sigma^2 = 1$ï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º</p>

\[\begin{align}
p(z) = \frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}z^2} \tag{4}
\end{align}\]

<p><strong>éšæœºå˜é‡</strong> $X$ <strong>æ ‡å‡†åŒ–çš„è¿‡ç¨‹ï¼Œå®é™…ä¸Šæ˜¯æ¶ˆé™¤é‡çº²å½±å“å’Œåˆ†å¸ƒå·®å¼‚çš„è¿‡ç¨‹ã€‚
é€šè¿‡å°†éšæœºå˜é‡çš„å€¼å‡å»å…¶å‡å€¼å†é™¤ä»¥æ ‡å‡†å·®ï¼Œä½¿å¾—éšæœºå˜é‡ä¸å…¶å‡å€¼çš„å·®è·å¯ä»¥ç”¨è‹¥å¹²ä¸ªæ ‡å‡†å·®æ¥è¡¡é‡ï¼Œä»è€Œå®ç°äº†ä¸åŒéšæœºå˜é‡ä¸å…¶å¯¹åº”å‡å€¼çš„å·®è·
å¯ä»¥ä»¥ä¸€ç§ç›¸å¯¹çš„è·ç¦»æ¥æ¯”è¾ƒã€‚</strong></p>

<h4 id="å¤šå…ƒæ ‡å‡†é«˜æ–¯åˆ†å¸ƒ-1">å¤šå…ƒæ ‡å‡†é«˜æ–¯åˆ†å¸ƒ</h4>
<p>é‚£ä¹ˆä¸€å…ƒæ ‡å‡†é«˜æ–¯åˆ†å¸ƒä¸å¤šå…ƒæ ‡å‡†é«˜æ–¯åˆ†å¸ƒæœ‰ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿäº‹å®ä¸Šï¼Œå¤šå…ƒæ ‡å‡†é«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°æ­£å¼ä»å¼(4)ä¸­å¯¼å‡ºçš„ã€‚
å‡è®¾æˆ‘ä»¬æœ‰éšæœºå‘é‡ $\overrightarrow{Z} = [Z_1, \cdots, Z_n]^T$ï¼Œå…¶ä¸­ $Z_i \sim \mathcal{N}(0,1)\ (i=1, \cdots, n)$
ä¸” $Z_i, Z_j\ (i,j=1, \cdots, n,\ i \neq j)$ å½¼æ­¤ç‹¬ç«‹ï¼Œå³éšæœºå‘é‡ä¸­çš„æ¯ä¸ªéšæœºå˜é‡ $Z_i$ éƒ½æœä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒä¸”ä¸¤ä¸¤å½¼æ­¤ç‹¬ç«‹ï¼Œ
åˆ™ç”±(4)ä¸ç‹¬ç«‹å˜é‡æ¦‚ç‡å¯†åº¦å‡½æ•°ä¹‹é—´çš„å…³ç³»ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°éšæœºå‘é‡ $\overrightarrow{Z} = [Z_1, \cdots, Z_n]^T$ çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º</p>

\[\begin{align}
p(z_1, \cdots, z_n) = \prod_{i=1}^{n} \frac{1}{\sqrt{2\pi}} e^{-\frac{1}{2}(z_i)^2}
\end{align}\]

\[\begin{align}
\qquad \qquad = \frac{1}{(2\pi)^{\frac{n}{2}}} e^{-\frac{1}{2}(Z^{T}Z)}
\end{align}\]

\[\begin{align}
1 = \int_{-\infty}^{\infty} \cdots \int_{-\infty}^{\infty} p(z_1, \cdots, z_n) dz_1 \cdots dz_n \tag{5}
\end{align}\]

<p>æˆ‘ä»¬ç§°éšæœºå‘é‡ $\overrightarrow{Z} \sim \mathcal{N}(\overrightarrow{0}, \boldsymbol{I})$ï¼Œå³éšæœºå‘é‡æœä»å‡å€¼ä¸ºé›¶å‘é‡ï¼Œåæ–¹å·®çŸ©é˜µä¸ºå•ä½çŸ©é˜µçš„é«˜æ–¯åˆ†å¸ƒã€‚
åœ¨è¿™é‡Œï¼Œéšæœºå‘é‡ $\overrightarrow{Z}$ çš„åæ–¹å·®çŸ©é˜µæ˜¯ $Conv(Z_i, Z_j), i,j = 1, \cdots, n$ ç»„æˆçš„çŸ©é˜µï¼Œå³</p>

\[\begin{align}
[Conv(Z_i, Z_j)]_{n \times n} = E[(Z - \overrightarrow{\mu})(Z - \overrightarrow{\mu})^T] = \boldsymbol{I} \tag{6}
\end{align}\]

<p>ç”±äºéšæœºå‘é‡ $\overrightarrow{Z}$ï¼Œæ‰€ä»¥å…¶åæ–¹å·®çŸ©é˜µçš„å¯¹è§’çº¿å…ƒç´ ä¸º1ï¼Œå…¶ä½™å…ƒç´ ä¸º0.
å¦‚æœæˆ‘ä»¬å–å¸¸æ•° $c = p(z_1, \cdots, z_n)$ï¼Œåˆ™å¯å¾—å‡½æ•° $p(z_1, \cdots, z_n)$ çš„ç­‰é«˜çº¿ä¸º $câ€™ = Z^T Z$ï¼Œå½“éšæœºå˜é‡ $\overrightarrow{Z}$ ä¸ºäºŒç»´å‘é‡æ—¶ï¼Œ
æˆ‘ä»¬æœ‰</p>

\[\begin{align}
c' = Z^T \cdot Z = (z_1 - 0)^2 + (z_2 - 0)^2 \tag{7}
\end{align}\]

<p>ç”±(7)å¯çŸ¥ï¼Œå…¶ç­‰é«˜çº¿ä¸ºä»¥(0,0)ä¸ºåœ†å¿ƒçš„åŒå¿ƒåœ†ã€‚</p>

<p><img src="../image/äºŒæ¬¡æ ‡å‡†é«˜æ–¯æ¦‚ç‡å¯†åº¦å‡½æ•°å›¾.jpg" alt="Figure 1" title="multi-gaussian" /></p>
<div align="center"> äºŒæ¬¡æ ‡å‡†é«˜æ–¯åˆ†å¸ƒæ¦‚ç‡å¯†åº¦å‡½æ•°å›¾ </div>

<h3 id="å¤šå…ƒé«˜æ–¯åˆ†å¸ƒ">å¤šå…ƒé«˜æ–¯åˆ†å¸ƒ</h3>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå½“éšæœºå˜é‡ $\overrightarrow{Z} \sim \mathcal{N}(\overrightarrow{0}, \boldsymbol{I})$ æ—¶ï¼Œ
å…¶æ¯ä¸ªéšæœºå˜é‡ $Z_i \sim \mathcal{N}(0,1)\ (i = 1, \cdots, n)$ å½¼æ­¤ç‹¬ç«‹ï¼Œæˆ‘ä»¬å¯é€šè¿‡å¼(4)ä¸ç‹¬ç«‹éšæœºå˜é‡æ¦‚ç‡å¯†åº¦å‡½æ•°ä¹‹é—´çš„å…³ç³»å¾—å‡ºå…¶è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆå¼5ï¼‰ã€‚
é‚£ä¹ˆï¼Œå¯¹äºä¸€èˆ¬çš„éšæœºå˜é‡ $\overrightarrow{X} \sim \mathcal{N}(\overrightarrow{\mu}, \sum)$ï¼Œ
å³å…¶æ¯ä¸ªéšæœºå˜é‡ $X_i \sim \mathcal{N}(\mu_i, \sigma_i^2)\ (i = 1, \cdots, n)$ ä¸” $X_i, X_j\ (i, j = 1, \cdots, n)$ å½¼æ­¤ä¸ç‹¬ç«‹çš„æƒ…å†µä¸‹ï¼Œ
æˆ‘ä»¬è¯¥å¦‚ä½•æ±‚éšæœºå‘é‡ $\overrightarrow{X}$ çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°å‘¢ï¼Ÿ
ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•æ˜¯ï¼Œ<strong>å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡çº¿æ€§å˜æ¢ï¼Œä½¿å¾—éšæœºå‘é‡</strong> $\overrightarrow{X} = [X_1, \cdots, X_n]^T$ <strong>ä¸­çš„æ¯ä¸ªéšæœºå˜é‡å½¼æ­¤ç‹¬ç«‹ï¼Œ
åˆ™æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç‹¬ç«‹éšæœºå˜é‡æ¦‚ç‡å¯†åº¦å‡½æ•°ä¹‹é—´çš„å…³ç³»æ±‚å‡ºå…¶è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚</strong>
äº‹å®ä¸Šï¼Œæˆ‘ä»¬æœ‰å®šç†ï¼š</p>
<blockquote>
  <p>å®šç†ï¼šè‹¥å­˜åœ¨éšæœºå‘é‡ $\overrightarrow{X} \sim \mathcal{N}(\overrightarrow{\mu}, \sum)$ï¼Œå…¶ä¸­ $\overrightarrow{\mu} \in \mathbb{R}^n$ ä¸ºå‡å€¼å‘é‡ï¼Œ
$\sum \in S_{++}^{n \times n}$ åŠæ­£å®šå®å¯¹ç§°çŸ©é˜µä¸º $\overrightarrow{X}$ çš„åæ–¹å·®çŸ©é˜µï¼Œåˆ™å­˜åœ¨æ»¡ç§©çŸ©é˜µ $B \in \mathbb{R}^{n \times n}$ï¼Œ
ä½¿å¾— $\overrightarrow{Z} = B^{-1}(\overrightarrow{X} - \overrightarrow{\mu})$ï¼Œ
è€Œ $\overrightarrow{Z} \sim \mathcal{N}(\overrightarrow{0}, \boldsymbol{I})$.</p>
</blockquote>

<p>æœ‰äº†å®šç†1ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹éšæœºå‘é‡ $\overrightarrow{X}$ åšç›¸åº”çš„çº¿æ€§å˜æ¢ï¼Œä½¿å¾—éšæœºå˜é‡åœ¨çº¿æ€§å˜æ¢åå½¼æ­¤ç‹¬ç«‹ï¼Œä»è€Œæ±‚å‡ºå…¶è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œå…·ä½“åœ°</p>

\[\begin{align}
\because\ \overrightarrow{Z} = B^{-1} (\overrightarrow{X} - \overrightarrow{\mu}), \overrightarrow{Z} \sim \mathcal{N}(\overrightarrow{0}, \boldsymbol{I}) \tag{8}
\end{align}\]

\[\begin{align}
\therefore\ p(Z_1, \cdots, z_n) = \frac{1}{(2\pi)^{\frac{n}{2}}} e^{-\frac{1}{2}(Z^T Z)}
\end{align}\]

\[\begin{align}
p(Z_1(x_1, \cdots, x_n), \cdots) = \frac{1}{(2\pi)^{\frac{n}{2}}} e^{-\frac{1}{2}[(B^{-1}(\overrightarrow{X} - \overrightarrow{\mu}))^T(B^{-1}(\overrightarrow{X} - \overrightarrow{\mu}))]}
\end{align}\]

\[\begin{align}
\qquad \qquad = \frac{1}{(2\pi)^{\frac{n}{2}}} e^{-\frac{1}{2}[((\overrightarrow{X} - \overrightarrow{\mu}))^T(BB^T)^{-1}((\overrightarrow{X} - \overrightarrow{\mu}))]}
\end{align}\]

\[\begin{align}
\therefore\ 1 = \int_{\infty}^{\infty}  \cdots \int_{\infty}^{\infty} p(z_1(x_1, \cdots, x_n), \cdots) dz_1 \cdots dz_n
\end{align}\]

\[\begin{align}
= \int_{\infty}^{\infty}  \cdots \int_{\infty}^{\infty} \frac{1}{(2\pi)^{\frac{n}{2}}} e^{-\frac{1}{2}[(\overrightarrow{X} - \overrightarrow{\mu})^T(BB^T)^{-1}(\overrightarrow{X} - \overrightarrow{\mu})]} dz_1 \cdots dz_n \tag{9}
\end{align}\]

<p>ç”±å¤šå…ƒå‡½æ•°æ¢å…ƒå˜æ¢å…¬å¼ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ±‚å‡ºé›…å¯æ¯”è¡Œåˆ—å¼ $J(\overrightarrow{Z} \rightarrow \overrightarrow{X})$ï¼Œç”±(8)å¯å¾—</p>

\[\begin{align}
J(\overrightarrow{Z} \rightarrow \overrightarrow{X}) = |B^{-1}| = |B|^{-1} = |B|^{-\frac{1}{2}} \cdot |B^T|^{-\frac{1}{2}} = |BB^T|^{-\frac{1}{2}} \tag{10}
\end{align}\]

<p>ç”±(9)(10)ï¼Œæˆ‘ä»¬å¯è¿›ä¸€æ­¥å¾—</p>

\[\begin{align}
1 = \int_{-\infty}^{\infty} \cdots \int_{-\infty}^{\infty} \frac{1}{(2\pi)^{\frac{n}{2}}|BB^T|^{\frac{1}{2}}} e^{-\frac{1}{2}[(\overrightarrow{X} - \overrightarrow{\mu})^T(BB^T)(\overrightarrow{X} - \overrightarrow{\mu})]} dx_1 \cdots dx_n \tag{11}
\end{align}\]

<p>æˆ‘ä»¬å¾—åˆ°éšæœºå‘é‡ $\overrightarrow{X} \sim \mathcal{N}(\overrightarrow{\mu}, \sum)$ çš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º</p>

\[\begin{align}
p(x_1, \cdots, x_n) = \frac{1}{(2\pi)^{\frac{n}{2}}|BB^T|^{\frac{1}{2}}} e^{-\frac{1}{2}|BB^T|^{\frac{1}{2}}} e^{-\frac{1}{2}[(\overrightarrow{X} - \overrightarrow{\mu})^T(BB^T)(\overrightarrow{X} - \overrightarrow{\mu})]} \tag{12}
\end{align}\]

<p>åœ¨(12)ä¸­ï¼Œéšæœºå‘é‡ $\overrightarrow{X}$ çš„åæ–¹å·®çŸ©é˜µè¿˜æœªå¾—åˆ°ä½“ç°ï¼Œæˆ‘ä»¬å¯é€šè¿‡çº¿æ€§å˜æ¢(8)åšè¿›ä¸€æ­¥å¤„ç†</p>

\[\begin{align}
\sum = \boldsymbol{E} [(\overrightarrow{X} - \overrightarrow{\mu})(\overrightarrow{X} - \overrightarrow{\mu})^T]
\end{align}\]

\[\begin{align}
\qquad = \boldsymbol{E} [(B\overrightarrow{Z} - \overrightarrow{0})(B\overrightarrow{Z} - \overrightarrow{0})^T]
\end{align}\]

\[\begin{align}
\qquad = \boldsymbol{Conv} (B\overrightarrow{Z}, B\overrightarrow{Z})
\end{align}\]

\[\begin{align}
\qquad = B \boldsymbol{Conv} (\overrightarrow{Z}, \overrightarrow{Z}) B^T
\end{align}\]

\[\begin{align}
\qquad = BB^T
\end{align}\]
:ET